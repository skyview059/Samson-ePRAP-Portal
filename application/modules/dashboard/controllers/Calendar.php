<?php defined('BASEPATH') OR exit('No direct script access allowed');class Calendar extends Admin_controller {    function __construct() {        parent::__construct();        $this->load->helper('dashboard');    }    public function index() {                 $this->viewAdminContent('calendar');        }        public function schedule(){          ajaxAuthorized();                $this->db->select('e.name as category_name');        $this->db->select('es.*,c.name as centre');               $this->db->select('IF(es.datetime < CURRENT_TIMESTAMP, "past", "upcoming") AS status');               $this->db->select('DATE_FORMAT(datetime,"%h:%i %p") AS time');               $this->db->from('exam_schedules as es');        $this->db->join('exams as e', 'e.id=es.exam_id','LEFT');        $this->db->join('exam_centres as c', 'c.id=es.exam_centre_id','LEFT');                //$this->db->where('es.datetime <=', "{$date}" );        //$date = $this->input->get('start');                //$date = date('Ym', strtotime( $date ));        //$this->db->where('DATE_FORMAT(es.datetime, "%Y%m") =', $date );        $exams = $this->db->get()->result();                       $sch = [];        foreach($exams as $e ){            $sch[] = [                'title'         => "{$e->time} {$e->category_name} ({$e->label})",                'className'     => $e->status,                'start'         => $e->datetime,                'end'           => date('Y-m-d H:i:s', strtotime($e->datetime . '+ 2 hour')),                'url'           => 'admin/exam/scenario/'.$e->id,                            ];        }          header('Content-Type: application/json');        echo json_encode($sch, JSON_PRETTY_PRINT);                    }    }